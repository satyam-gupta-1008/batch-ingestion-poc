{"timestamp":"2025-09-04T11:32:23.845002","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-04T11:32:23.845228","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/dynamic-airbyte-with-airflow.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-04T11:32:24.342549","level":"info","event":"Trying to parse the dbt project using dbt ls cache cosmos_cache__airbyte_dynamic_connection__my_project_dbt_group_11...","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-09-04T11:32:24.379178","level":"info","event":"Cosmos performance: time to calculate cache identifier cosmos_cache__airbyte_dynamic_connection__my_project_dbt_group_11 for current version: 0.029229541978565976","logger":"cosmos.cache"}
{"timestamp":"2025-09-04T11:32:24.379267","level":"info","event":"Cosmos performance [2b2e84620275|1788]: The cache size for cosmos_cache__airbyte_dynamic_connection__my_project_dbt_group_11 is 4335","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-09-04T11:32:24.379423","level":"info","event":"Cosmos performance: Cache hit for cosmos_cache__airbyte_dynamic_connection__my_project_dbt_group_11 - aad8d04d72ff7b6917b24f4cd2f34a0b,d41d8cd98f00b204e9800998ecf8427e","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-09-04T11:32:24.379752","level":"info","event":"Total nodes: 6","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-09-04T11:32:24.379787","level":"info","event":"Total filtered nodes: 6","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-09-04T11:32:24.379822","level":"info","event":"Cosmos performance (airbyte_dynamic_connection__my_project_dbt_group_11) -  [2b2e84620275|1788]: It took 0.0373s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE","logger":"cosmos.converter"}
{"timestamp":"2025-09-04T11:32:24.380042","level":"info","event":"Project /opt/airflow/dbt/my_project_dbt does not have {'dependencies.yml', 'packages.yml'}","logger":"cosmos.dbt.project"}
{"timestamp":"2025-09-04T11:32:24.380607","level":"info","event":"Project /opt/airflow/dbt/my_project_dbt does not have {'dependencies.yml', 'packages.yml'}","logger":"cosmos.dbt.project"}
{"timestamp":"2025-09-04T11:32:24.381473","level":"info","event":"Project /opt/airflow/dbt/my_project_dbt does not have {'dependencies.yml', 'packages.yml'}","logger":"cosmos.dbt.project"}
{"timestamp":"2025-09-04T11:32:24.381829","level":"info","event":"Project /opt/airflow/dbt/my_project_dbt does not have {'dependencies.yml', 'packages.yml'}","logger":"cosmos.dbt.project"}
{"timestamp":"2025-09-04T11:32:24.382167","level":"info","event":"Project /opt/airflow/dbt/my_project_dbt does not have {'dependencies.yml', 'packages.yml'}","logger":"cosmos.dbt.project"}
{"timestamp":"2025-09-04T11:32:24.382571","level":"info","event":"Project /opt/airflow/dbt/my_project_dbt does not have {'dependencies.yml', 'packages.yml'}","logger":"cosmos.dbt.project"}
{"timestamp":"2025-09-04T11:32:24.382870","level":"info","event":"Cosmos performance (airbyte_dynamic_connection__my_project_dbt_group_11) - [2b2e84620275|1788]: It took 0.00305s to build the Airflow DAG.","logger":"cosmos.converter"}
{"timestamp":"2025-09-04T11:32:24.383401","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:\n  PydanticSerializationUnexpectedValue(Expected `str` - serialized value may not be as expected [input_value={'version': 'aad8d04d72ff...y_project_dbt_group_11'}, input_type=dict])\n  return self.__pydantic_serializer__.to_python(\n","logger":"py.warnings"}
{"timestamp":"2025-09-04T11:32:24.395557Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:24.395678Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:24.395733Z","level":"info","event":"Current task name:my_project_dbt_group_11.stg_weather_data_run","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:24.395799Z","level":"info","event":"Dag name:airbyte_dynamic_connection","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:25.209012","level":"info","event":"dbtRunner is available. Using dbtRunner for invoking dbt.","logger":"cosmos.operators.base"}
{"timestamp":"2025-09-04T11:32:25.210212","level":"info","event":"Cloning project to writable temp directory /tmp/tmp_5ehkvnz from /opt/airflow/dbt/my_project_dbt","logger":"cosmos.operators.base"}
{"timestamp":"2025-09-04T11:32:25.212637","level":"info","event":"Partial parse is enabled and the latest partial parse file is /tmp/cosmos/airbyte_dynamic_connection__my_project_dbt_group_11/target/partial_parse.msgpack","logger":"cosmos.operators.base"}
{"timestamp":"2025-09-04T11:32:25.215959","level":"info","event":"Profile caching is enable.","logger":"cosmos.config"}
{"timestamp":"2025-09-04T11:32:25.221825","level":"info","event":"Connection Retrieved 'test-airbyte-and-dbt-with-airflow'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-04T11:32:25.222252","level":"info","event":"Using real values for profile dbt_postgres_profile","logger":"cosmos.profiles.base"}
{"timestamp":"2025-09-04T11:32:25.222806","level":"info","event":"Profile not found in cache storing and using profile: /tmp/cosmos/profile/2a376c19ef40c3750992fe5768e4b9f3d630cca0747e23a4e93687cdf8a5749c/profiles.yml.","logger":"cosmos.config"}
{"timestamp":"2025-09-04T11:32:25.223022","level":"info","event":"Trying to run dbtRunner with:\n ['run', '--select', 'stg_weather_data', '--project-dir', '/tmp/tmp_5ehkvnz', '--profiles-dir', '/tmp/cosmos/profile/2a376c19ef40c3750992fe5768e4b9f3d630cca0747e23a4e93687cdf8a5749c', '--profile', 'dbt_postgres_profile', '--target', 'dev', '--no-static-parser']\n in /tmp/tmp_5ehkvnz","logger":"cosmos.dbt.runner"}
{"timestamp":"2025-09-04T11:32:25.243220Z","level":"info","event":"\u001b[0m11:32:25  Running with dbt=1.8.2","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:25.452310Z","level":"info","event":"\u001b[0m11:32:25  Registered adapter: postgres=1.8.2","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:25.852811Z","level":"info","event":"\u001b[0m11:32:25  Unable to do partial parsing because profile has changed","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.330617Z","level":"info","event":"\u001b[0m11:32:26  Found 5 models, 1 source, 428 macros","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.331491Z","level":"info","event":"\u001b[0m11:32:26","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.450372Z","level":"info","event":"\u001b[0m11:32:26  Concurrency: 1 threads (target='dev')","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.450601Z","level":"info","event":"\u001b[0m11:32:26","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.452130Z","level":"info","event":"\u001b[0m11:32:26  1 of 1 START sql table model dbt.stg_weather_data .............................. [RUN]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.491068Z","level":"info","event":"\u001b[0m11:32:26  1 of 1 ERROR creating sql table model dbt.stg_weather_data ..................... [\u001b[31mERROR\u001b[0m in 0.04s]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.505464Z","level":"info","event":"\u001b[0m11:32:26","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.505603Z","level":"info","event":"\u001b[0m11:32:26  Finished running 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.516788Z","level":"info","event":"\u001b[0m11:32:26","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517053Z","level":"info","event":"\u001b[0m11:32:26  \u001b[31mCompleted with 1 error and 0 warnings:\u001b[0m","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517196Z","level":"info","event":"\u001b[0m11:32:26","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517448Z","level":"info","event":"\u001b[0m11:32:26    Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517542Z","level":"info","event":"  cross-database references are not implemented: \"airflow.public.raw_weather_data\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517580Z","level":"info","event":"  LINE 15:     select * from \"airflow\".\"public\".\"raw_weather_data\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517615Z","level":"info","event":"                             ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517649Z","level":"info","event":"  compiled code at target/run/my_project_dbt/models/staging/stg_weather_data.sql","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517710Z","level":"info","event":"\u001b[0m11:32:26","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:26.517776Z","level":"info","event":"\u001b[0m11:32:26  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.754250","level":"info","event":"Inlets: []","logger":"cosmos.operators.base"}
{"timestamp":"2025-09-04T11:32:27.754350","level":"info","event":"Outlets: []","logger":"cosmos.operators.base"}
{"timestamp":"2025-09-04T11:32:27.754448","level":"info","event":"Assigning outlets with DatasetAlias in Airflow 3","logger":"cosmos.operators.local"}
{"timestamp":"2025-09-04T11:32:27.756641","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"CosmosDbtRunError","exc_value":"dbt invocation completed with errors: stg_weather_data: Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)\n  cross-database references are not implemented: \"airflow.public.raw_weather_data\"\n  LINE 15:     select * from \"airflow\".\"public\".\"raw_weather_data\"\n                             ^\n  compiled code at target/run/my_project_dbt/models/staging/stg_weather_data.sql","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":918,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1213,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/base.py","lineno":310,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":851,"name":"build_and_run_cmd"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":648,"name":"run_command"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":258,"name":"handle_exception_dbt_runner"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/dbt/runner.py","lineno":113,"name":"handle_exception_if_needed"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-04T11:32:27.767364Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.767575Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.767683Z","level":"info","event":"Task:<Task(DbtRunLocalOperator): my_project_dbt_group_11.stg_weather_data_run>","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.767749Z","level":"info","event":"Failure caused by dbt invocation completed with errors: stg_weather_data: Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.767841Z","level":"info","event":"  cross-database references are not implemented: \"airflow.public.raw_weather_data\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.767961Z","level":"info","event":"  LINE 15:     select * from \"airflow\".\"public\".\"raw_weather_data\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.768081Z","level":"info","event":"                             ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.768169Z","level":"info","event":"  compiled code at target/run/my_project_dbt/models/staging/stg_weather_data.sql","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.786883Z","level":"error","event":"/usr/local/lib/python3.12/multiprocessing/resource_tracker.py:279: UserWarning: resource_tracker: There appear to be 2 leaked semaphore objects to clean up at shutdown","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-04T11:32:27.787044Z","level":"error","event":"  warnings.warn('resource_tracker: There appear to be %d '","chan":"stderr","logger":"task"}
